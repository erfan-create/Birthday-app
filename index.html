<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Natalia Birthday Surprise</title>
  <style>
    body { margin:0; font-family:sans-serif; background:#fff7fb; overflow-x:hidden; }
    .screen { display:none; height:100vh; width:100%; text-align:center; }
    .active { display:flex; flex-direction:column; justify-content:center; align-items:center; }
    button { padding:10px 20px; margin-top:20px; border:none; border-radius:10px; background:#e91e63; color:white; font-weight:bold; cursor:pointer; }

    /* Intro fading text */
    .fade-text { font-size:2em; opacity:0; transition: opacity 2s; position:absolute; text-align:center; width:100%; top:40%; }

    /* Puzzle grid */
    .grid { display:grid; grid-template-columns:repeat(4,1fr); gap:10px; justify-content:center; max-width:400px; }
    .card3d { perspective:1000px; cursor:pointer; }
    .card-inner { position:relative; width:100%; padding-top:100%; transform-style:preserve-3d; transition: transform .5s; }
    .card3d.flipped .card-inner { transform: rotateY(180deg); }
    .face { position:absolute; inset:0; backface-visibility:hidden; border-radius:8px; overflow:hidden; display:flex; align-items:center; justify-content:center; border:1px solid #ccc; }
    .front { background:#f9fafb; font-size:24px; font-weight:bold; color:#888; }
    .back { transform: rotateY(180deg); background:white; }
    .back img { width:100%; height:100%; object-fit:cover; }

    /* Flower wall */
    .flower-wall { display:flex; flex-wrap:wrap; gap:8px; justify-content:center; }
    .flower-wall img { width:80px; height:80px; object-fit:cover; border-radius:8px; }

    /* Scrambled puzzle */
    .word-bank, .answer-area { display:flex; flex-wrap:wrap; gap:8px; margin:10px; justify-content:center; }
    .word { background:#f8bbd0; padding:5px 10px; border-radius:8px; cursor:pointer; }
    .answer-area .word { background:#e1bee7; }

    /* Video modal */
    #videoModal { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.8); justify-content:center; align-items:center; }
    #videoModal video { max-width:90%; max-height:80%; }

    /* Final */
    #final { background:#ffe4ec; color:#333; font-size:2em; position:relative; overflow:hidden; }
    #finalMessage { opacity:0; transition: opacity 3s; }

    /* Petals animation */
    .petal {
      position:absolute;
      width:20px;
      height:20px;
      background:pink;
      border-radius:50%;
      opacity:0.7;
      animation: fall linear infinite;
    }
    @keyframes fall {
      from { transform: translateY(-10vh) rotate(0deg); opacity:0.8; }
      to { transform: translateY(110vh) rotate(360deg); opacity:0; }
    }
  </style>
</head>
<body>

  <!-- Landing -->
  <section class="screen active" id="landing">
    <button id="landingStart">Start</button>
  </section>

  <!-- Intro -->
  <section class="screen" id="intro">
    <div id="introText" class="fade-text"></div>
    <button id="introBtn" style="display:none;">Start Puzzle</button>
  </section>

  <!-- Puzzle 1 -->
  <section class="screen" id="puzzle1">
    <h2>Find the matching flowers</h2>
    <div class="grid" id="memoryGrid"></div>
  </section>

  <!-- Flower wall -->
  <section class="screen" id="flowerWall">
    <h2>You are the rarest flower in the garden of Earth ðŸŒ¸</h2>
    <div class="flower-wall" id="flowerGallery"></div>
    <button id="toPuzzle2">Continue</button>
  </section>

  <!-- Puzzle 2 -->
  <section class="screen" id="puzzle2">
    <h2>Arrange the words in the correct order</h2>
    <div class="word-bank" id="wordBank"></div>
    <div class="answer-area" id="answerArea"></div>
    <button id="checkSentence">Check</button>
  </section>

  <!-- Message page -->
  <section class="screen" id="messagePage">
    <button id="showVideo">The message</button>
  </section>

  <!-- Video modal -->
  <div id="videoModal">
    <video id="messageVideo" controls>
      <source src="message-video.mp4" type="video/mp4">
    </video>
  </div>

  <!-- Final -->
  <section class="screen" id="final">
    <div id="finalMessage">Happy birthday Natalia â€“ 08.09.2025</div>
  </section>

  <!-- Background music -->
  <audio id="bgMusic" src="Audio.mp3" loop></audio>

  <script>
    const screens=["landing","intro","puzzle1","flowerWall","puzzle2","messagePage","final"];
    function go(id){ screens.forEach(s=>document.getElementById(s).classList.remove("active")); document.getElementById(id).classList.add("active"); }

    const bgMusic=document.getElementById("bgMusic");

    // Landing
    document.getElementById("landingStart").addEventListener("click",()=>{
      bgMusic.volume=1; bgMusic.play().catch(()=>{}); // start music safely
      go("intro");
      runIntro();
    });

    // Intro fading text
    const introLines=["Hello Natalia","this is","a small digital gift","for you","with love"];
    function runIntro(){
      let idx=0;
      const text=document.getElementById("introText");
      function nextLine(){
        if(idx<introLines.length){
          text.textContent=introLines[idx++];
          text.style.opacity=1;
          setTimeout(()=>{text.style.opacity=0; setTimeout(nextLine,2000);},2000);
        } else {
          document.getElementById("introBtn").style.display="block";
        }
      }
      nextLine();
    }
    document.getElementById("introBtn").addEventListener("click",()=>go("puzzle1"));

    // Puzzle 1 (memory)
    const flowerImages=["Frangipani1.jpg","Frangipani2.jpg","Peony1.jpg","Peony2.jpg","Pinkrose.jpg","White1.jpg"];
    const grid=document.getElementById("memoryGrid"); let first=null,lock=false,matched=0;
    function buildDeck(){
      const deck=[...flowerImages,...flowerImages].map((src,i)=>({id:i,src,key:src}));
      for(let i=deck.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[deck[i],deck[j]]=[deck[j],deck[i]];}
      grid.innerHTML=deck.map(c=>`
        <div class="card3d" data-key="${c.key}">
          <div class="card-inner">
            <div class="face front">ðŸŒ¸</div>
            <div class="face back"><img src="${c.src}" alt="flower"></div>
          </div>
        </div>`).join("");
      first=null; lock=false; matched=0;
    }
    buildDeck();
    grid.addEventListener("click",e=>{
      const card=e.target.closest(".card3d"); if(!card||lock||card.classList.contains("flipped")) return;
      card.classList.add("flipped");
      if(!first){first=card;return;}
      lock=true;
      const match=first.dataset.key===card.dataset.key;
      setTimeout(()=>{
        if(!match){first.classList.remove("flipped"); card.classList.remove("flipped");}
        else{matched++; if(matched===flowerImages.length){showFlowerWall();}}
        first=null; lock=false;
      },600);
    });

    // Flower wall
    function showFlowerWall(){
      go("flowerWall");
      const gal=document.getElementById("flowerGallery"); gal.innerHTML="";
      for(let i=0;i<120;i++){const img=document.createElement("img"); img.src=flowerImages[i%flowerImages.length]; gal.appendChild(img);}
    }
    document.getElementById("toPuzzle2").addEventListener("click",()=>go("puzzle2"));

    // Puzzle 2 (scrambled words)
    const sentence="The world became bright and colorful on this day when you opened your diamond eyes to the world";
    const words=sentence.split(" ");
    const wordBank=document.getElementById("wordBank");
    const answerArea=document.getElementById("answerArea");
    function buildWords(){
      wordBank.innerHTML=""; answerArea.innerHTML="";
      words.forEach(w=>{
        const btn=document.createElement("div"); btn.className="word"; btn.textContent=w;
        btn.addEventListener("click",()=>{answerArea.appendChild(btn);});
        wordBank.appendChild(btn);
      });
    }
    buildWords();
    answerArea.addEventListener("click",e=>{
      if(e.target.classList.contains("word")){wordBank.appendChild(e.target);}
    });
    document.getElementById("checkSentence").addEventListener("click",()=>{
      const attempt=[...answerArea.querySelectorAll(".word")].map(w=>w.textContent).join(" ");
      if(attempt===sentence){go("messagePage");} else {alert("Not quite right, try again!");}
    });

    // Video and music fade
    const modal=document.getElementById("videoModal");
    const video=document.getElementById("messageVideo");
    document.getElementById("showVideo").addEventListener("click",()=>{modal.style.display="flex"; video.play(); fadeVolume(0.1,2000);});
    video.addEventListener("ended",()=>{modal.style.display="none"; fadeVolume(1,2000); showFinal();});
    modal.addEventListener("click",e=>{if(e.target===modal){modal.style.display="none"; video.pause(); fadeVolume(1,2000); showFinal();}});
    function fadeVolume(target,duration){
      const step=0.05; const interval=duration*step/1000; const timer=setInterval(()=>{
        if(Math.abs(bgMusic.volume-target)<0.05){bgMusic.volume=target; clearInterval(timer);}
        else{bgMusic.volume += (bgMusic.volume<target?step:-step);}
      },interval*1000);
    }

    // Final
    function showFinal(){
      go("final");
      setTimeout(()=>{document.getElementById("finalMessage").style.opacity=1;},500);
      spawnPetals();
    }

    // Petals
    function spawnPetals(){
      const final=document.getElementById("final");
      for(let i=0;i<30;i++){
        const p=document.createElement("div");
        p.className="petal";
        p.style.left=Math.random()*100+"vw";
        p.style.animationDuration=(5+Math.random()*5)+"s";
        final.appendChild(p);
        setTimeout(()=>p.remove(),10000);
      }
      setInterval(spawnPetals,4000);
    }
  </script>
</body>
</html>

